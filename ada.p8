pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
car={x=64, y=30}
bullets = {}
obs={}

function fire()
  if (btnp(4)) then
    local b = {
      x = car.x,
      y = car.y,
      dx = 3
    }
    add(bullets, b)
    sfx(3)    
  end
end

function move_bullets()
  for b in all(bullets) do
    b.x += b.dx
    if (b.x > 127) then
      del(bullets, b)
    end
  end
end

function move_car()
  if (btn(0)) then 
    car.x=car.x-1
    if (car.x < 0) then
      car.x=0
    end   
  end
  if (btn(1)) then 
  	car.x=car.x+1
  	if (car.x > 127) then
  	  car.x = 0
  	  new_obsticles()
  	end 
  end
  if (btn(2)) then   	
  	car.y=car.y-1 
  	if (car.y < 22) then
  	  car.y = 22
  	  sfx(0)
  	end
  end
  if (btn(3)) then 
    car.y=car.y+1
    if (car.y > 40) then
      car.y = 40
      sfx(0)
    end 
  end
end

function new_obs()
  //draw 3 obstacles in 2 lanes
  obs = {}
  local y = 35
  local x = 80
  yp=rnd(3)
  if (yp == 0) then y = 35
  if (yp == 1) then y = 30
  if (yp == 2) then y = 25
  local o = {
    x=rnd(80)+30,
    y=y
    sp=6
  }
  add(obs,o)
end

function draw_obs()
  for o in all(obs) do
    spr(o.sp, o.x, o.y)
  end
end

function _update()
  update_obsticles()
  fire()
  move_car()
  move_bullets()
end

function _draw()
  cls()
  map()
  spr(1,car.x,car.y)
  for b in all(bullets) do
    spr(5, b.x, b.y)
  end
end

__gfx__
000000000000000055555555bbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000055555555bbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000aaaa00055555555bbbbbbbbbbb3b3bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000aa0a000aa55aa55bbbbbbbbbbbb3bbb0000006600000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000aaaaaa055555555bbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000aaaaaa055555555bbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000030030055555555bbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000055555555bbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0303030303030303040303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0403030303040303030303030403030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0403030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303040303030303030304030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030403030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000400001a720167101471012710107100c710017000d7000d7000d7000d7000d7000d7000d7000c0000c0000c000000000000000000000000000000000000000000000000000000000000000000000000000000
00100000137500e750117500c75010750117501875011750137500c7501175013750117500c750137500e750137500e750117500c75013750137500e750137500c750117500e7500e750107500c750137500c750
000e00000e550115500c550115500050011550005001155000500115500050011550005001155011550135500c5500e550115500c55013550115500e5500c55013550115500e550135500c550115501055013550
00040000000000000000000000000000034650306502d65026650206501a65016650116500b650016400a60000000000000000000000000000000008000080000800008000080000000000000000000000000000
__music__
00 01424344
00 01024344

